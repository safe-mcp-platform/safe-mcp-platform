{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://safe-mcp-platform.io/schemas/technique.json",
  
  "id": "SAFE-T1105",
  "name": "Path Traversal via File Access Tools",
  "severity": "CRITICAL",
  "tactic": "Privilege Escalation",
  "description": "Detects attempts to access files outside the intended sandbox directory using path traversal sequences (../, ../../, etc.). Attackers exploit MCP file system tools to read sensitive files like /etc/passwd, ~/.ssh/id_rsa, or application secrets. This is the second most common MCP attack, accounting for approximately 25% of real-world exploits, and has 95%+ detection accuracy due to deterministic patterns.",
  
  "detection": {
    "patterns": {
      "enabled": true,
      "file": "patterns/T1105_patterns.txt",
      "confidence": 0.98,
      "case_sensitive": false,
      "note": "20+ patterns covering all OS variants and encoding schemes"
    },
    "ml_model": {
      "enabled": true,
      "name": "safe-mcp/T1105-path-traversal-detector",
      "threshold": 0.80,
      "confidence": 0.90,
      "note": "Fine-tuned RoBERTa model with 90.5% accuracy"
    },
    "rules": {
      "enabled": true,
      "validator": "rules.T1105_path_traversal_rules.validate_file_path",
      "confidence": 0.99,
      "note": "Path normalization + sandbox boundary checks"
    },
    "behavioral": {
      "enabled": true,
      "patterns": [
        "repeated_access_attempts",
        "directory_enumeration",
        "privilege_file_targeting"
      ],
      "lookback_window": 300,
      "confidence": 0.82,
      "note": "Pattern of escalating file access attempts"
    }
  },
  
  "examples": {
    "malicious": [
      "../../../etc/passwd",
      "..\\..\\..\\windows\\system32\\config\\sam",
      "....//....//....//etc/shadow",
      "%2e%2e%2f%2e%2e%2f%2e%2e%2fetc%2fpasswd",
      "../../../../../../root/.ssh/id_rsa",
      "/var/www/html/../../etc/passwd",
      "file:///etc/passwd",
      "\\\\?\\C:\\Windows\\System32\\config\\SAM",
      "..%252f..%252f..%252fetc%252fpasswd",
      "..;/..;/..;/etc/passwd",
      "./../.ssh/id_rsa",
      "..%c0%af..%c0%af..%c0%afetc/passwd",
      "documents/../../.env",
      "../../../../../proc/self/environ",
      "~/../../../etc/hosts",
      "..\\..\\..\\AppData\\Roaming\\secrets.txt",
      "/etc/passwd%00.txt",
      "....\\\\....\\\\....\\\\windows\\system.ini",
      "․․/․․/․․/etc/passwd",
      "../uploads/../../config/database.yml"
    ],
    "benign": [
      "documents/report.pdf",
      "images/photo.jpg",
      "data/export.csv",
      "./current_directory/file.txt",
      "workspace/projects/readme.md",
      "uploads/user123/avatar.png",
      "downloads/invoice_2025.pdf",
      "config/settings.json",
      "logs/app.log",
      "temp/processing/data.tmp"
    ]
  },
  
  "response": {
    "action": "BLOCK",
    "log_level": "CRITICAL",
    "alert": true,
    "custom_message": "Path traversal attempt detected. File access has been blocked for security reasons."
  },
  
  "metadata": {
    "contributor": "@saurabh-yergattikar",
    "created": "2025-11-22",
    "updated": "2025-11-22",
    "status": "approved",
    "version": "1.0",
    "references": [
      "https://github.com/safe-mcp/safe-mcp/blob/main/techniques/T1105.md",
      "https://owasp.org/www-community/attacks/Path_Traversal",
      "https://cwe.mitre.org/data/definitions/22.html"
    ]
  },
  
  "testing": {
    "test_file": "tests/test_T1105_path_traversal.py",
    "test_cases": 347,
    "coverage": 0.97,
    "false_positive_rate": 0.005,
    "false_negative_rate": 0.042
  },
  
  "performance": {
    "avg_latency_ms": 18.2,
    "p95_latency_ms": 32.7,
    "p99_latency_ms": 48.1,
    "cpu_usage": 0.22,
    "memory_mb": 98.5
  },
  
  "ml_model_details": {
    "base_model": "roberta-base",
    "fine_tuned_on": 980,
    "training_epochs": 4,
    "accuracy": 0.905,
    "precision": 0.923,
    "recall": 0.887,
    "f1_score": 0.904,
    "published_to": "https://huggingface.co/safe-mcp/T1105-path-traversal-detector"
  },
  
  "patterns_summary": {
    "total_patterns": 23,
    "categories": [
      "unix_traversal",
      "windows_traversal",
      "url_encoded",
      "double_encoded",
      "unicode_encoded",
      "null_byte_injection",
      "mixed_encoding",
      "absolute_paths"
    ]
  },
  
  "rules_summary": {
    "total_rules": 12,
    "checks": [
      "path_normalization",
      "sandbox_boundary_validation",
      "absolute_path_blocking",
      "symlink_resolution",
      "url_scheme_validation",
      "null_byte_detection",
      "whitelist_validation",
      "character_encoding_check",
      "drive_letter_validation",
      "unc_path_blocking",
      "tilde_expansion_check",
      "relative_path_depth_limit"
    ]
  },
  
  "sandbox_config": {
    "allowed_base_paths": [
      "/workspace",
      "/home/{username}/documents",
      "/tmp/mcp-safe",
      "./data"
    ],
    "blocked_paths": [
      "/etc",
      "/root",
      "/var/log",
      "/proc",
      "/sys",
      "~/.ssh",
      "C:\\Windows",
      "C:\\Program Files"
    ],
    "max_relative_depth": 3,
    "follow_symlinks": false,
    "allow_absolute_paths": false
  }
}

